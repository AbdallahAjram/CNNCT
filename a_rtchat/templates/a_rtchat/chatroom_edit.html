{% extends 'layouts/box.html' %}

{% block content %}

<h1 class="mb-6 text-2xl font-semibold">Edit Chat</h1>
<form method="post" class="space-y-6">
    {% csrf_token %}
    <div class="p-4 rounded-xl border border-gray-200 bg-white">
        {{ form }}
    </div>

    <div class="p-4 rounded-xl border border-gray-200 bg-white">
        <h2 class="text-lg font-semibold mb-3">Members</h2>
        <div class="divide-y">
        {% for member in chat_group.members.all %}
            <div class="flex justify-between items-center py-3">
                <div class="flex items-center gap-3">
                    <img class="w-10 h-10 rounded-full object-cover" src="{{ member.profile.avatar }}"/>
                    <div>
                        <div class="font-semibold">{{ member.profile.name }}</div>
                        <div class="text-xs text-gray-500">@{{ member.username }}</div>
                    </div>
                </div>
                {% if member != chat_group.admin %}
                <div class="flex items-center gap-3">
                    <input type="checkbox" id="rm-{{member.id}}" name="remove_members" value="{{member.id}}" class="hidden">
                    <button type="button" class="px-3 py-1.5 rounded-md bg-red-600 text-white hover:bg-red-500" onclick="(function(){ const cb=document.getElementById('rm-{{member.id}}'); if(cb){ cb.checked=true; document.forms[0].submit(); } })()">Remove</button>
                </div>
                {% endif %}
            </div>
        {% endfor %}
        </div>
    </div>
    <div class="flex justify-between items-center">
        <a class="text-gray-400 hover:text-red-500" href="{% url 'chatroom-delete' chat_group.group_name %}">Delete Chatroom</a>
        <button class="px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-500" type="submit">Update</button>
    </div>
</form>

{% endblock %}